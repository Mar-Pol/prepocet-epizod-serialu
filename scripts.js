function initTheme(){"true"===localStorage.getItem("darkMode")?(document.body.classList.add("dark-mode"),document.getElementById("themeToggle").checked=!0,document.querySelector(".slider .icon").textContent="\uD83C\uDF19"):(document.body.classList.remove("dark-mode"),document.getElementById("themeToggle").checked=!1,document.querySelector(".slider .icon").textContent="\uD83C\uDF1E")}function toggleDarkMode(){document.body.classList.toggle("dark-mode");let e=document.body.classList.contains("dark-mode"),t=document.querySelector(".slider .icon");t.style.opacity="0",setTimeout(()=>{t.textContent=e?"\uD83C\uDF19":"\uD83C\uDF1E",t.style.opacity="1"},200),localStorage.setItem("darkMode",e.toString())}function validateInput(e){e.value.includes("-")&&(e.value=e.value.replace("-",""))}function initTooltip(){let e=document.getElementById("helpIcon"),t=document.getElementById("tooltip");e&&t&&(e.addEventListener("mouseover",()=>{t.style.display="block";let n=e.getBoundingClientRect(),o=n.right+10;o+t.offsetWidth>window.innerWidth&&(o=n.left-t.offsetWidth-10),t.style.top=n.top+window.scrollY+"px",t.style.left=o+"px"}),e.addEventListener("mouseout",()=>t.style.display="none"))}function _showPopup(e,t){let n=document.createElement("div");n.textContent=e,n.className="popup "+t,document.body.appendChild(n),setTimeout(()=>document.body.removeChild(n),3e3)}function showError(e){_showPopup(e,"popup-error")}function showInfo(e){_showPopup(e,"popup-info")}function initInputFields(){let e=document.getElementById("episodes"),t=document.getElementById("episodeRange"),n=document.getElementById("borderMin"),o=document.getElementById("borderMax"),i=document.getElementById("hours"),l=document.getElementById("minutes");[e,i,l,n,o,t].forEach(e=>{!function e(t){t.addEventListener("keypress",function(e){"0"===e.key&&0===t.value.length&&(e.preventDefault(),showError("Č\xedslo nem\xf4že zač\xednať nulou."))})}(e)}),e.addEventListener("input",toggleTimeInput),n.addEventListener("input",toggleTimeInput),o.addEventListener("input",toggleTimeInput),i.addEventListener("input",toggleEpisodeInput),l.addEventListener("input",toggleEpisodeInput),t.addEventListener("blur",function(){let e=this.value,t=e.replace(/[–—]/g,"-").replace(/^-+|-+$/g,"").trim();this.value=t,t!==e&&/[–—-]/.test(e)&&showInfo("Bolo odstr\xe1nen\xe9 '-' na konci."),validateRangeOrSingle(t)||(showError("Zadajte platn\xfd rozsah napr. '40-50'."),this.value="")}),t.addEventListener("keypress",function(e){e.which>=48&&e.which<=57||[45,8211,8212].includes(e.which)||(e.preventDefault(),showError("Povolen\xe9 iba č\xedslice a pomlčka."))}),[i,l,n,o].forEach(e=>{e.addEventListener("keypress",function(e){/[0-9]/.test(e.key)||(e.preventDefault(),showError("Povolen\xe9 iba č\xedslice."))})}),e.addEventListener("blur",function(){let e=this.value.trim();e.endsWith("+")&&(this.value=e.replace(/\++$/,""),showInfo("Bolo odstr\xe1nen\xe9 '+' na konci."));let t=this.value;t&&!/^\d+(\+\d+)*$/.test(t)&&(showError("Neplatn\xfd form\xe1t pre epiz\xf3dy. Použi '12+8'."),this.value="")}),e.addEventListener("keypress",function(e){/[0-9]/.test(e.key)||"+"===e.key||(e.preventDefault(),showError("Povolen\xe9 iba č\xedslice a '+'."))})}function toggleEpisodeInput(){let e=document.getElementById("hours").value,t=document.getElementById("minutes").value,n=document.getElementById("episodes"),o=document.getElementById("borderMin"),i=document.getElementById("borderMax"),l=document.getElementById("episodeMsgAlert"),s=document.getElementById("minMsgAlert"),r=document.getElementById("maxMsgAlert");if(e||t){n.disabled=!0,o.disabled=!0,i.disabled=!0,n.value="",o.value="",i.value="";let d="<span style='color:orange;'>Tento \xfadaj nie je potrebn\xfd pri v\xfdpočte, pretože sa použije zadan\xfd čas.</span>";l&&(l.innerHTML=d),s&&(s.innerHTML=d),r&&(r.innerHTML=d)}else n.disabled=!1,o.disabled=!1,i.disabled=!1,l&&(l.innerHTML=""),s&&(s.innerHTML=""),r&&(r.innerHTML="")}function toggleTimeInput(){let e=document.getElementById("episodes").value,t=document.getElementById("borderMin").value,n=document.getElementById("borderMax").value,o=document.getElementById("hours"),i=document.getElementById("minutes"),l=document.getElementById("hoursMsgAlert"),s=document.getElementById("minutesMsgAlert");if(e||t||n){o.disabled=!0,i.disabled=!0,o.value="",i.value="";let r="<span style='color:orange;'>Odhadovan\xfd počet hod\xedn bude vypoč\xedtan\xfd.</span>";l&&(l.innerHTML=r),s&&(s.innerHTML=r)}else o.disabled=!1,i.disabled=!1,l&&(l.innerHTML=""),s&&(s.innerHTML="")}function validateRangeOrSingle(e){let t=e.replace(/[–—]/g,"-").replace(/^-+|-+$/g,"").trim();if(/^[1-9][0-9]*$/.test(t))return!0;if(/^[1-9][0-9]*-[1-9][0-9]*$/.test(t)){let[n,o]=t.split("-").map(Number);return n<=o}return!1}document.addEventListener("DOMContentLoaded",function(){initTheme(),initTooltip(),initInputFields()}),window.onload=()=>{null===localStorage.getItem("darkMode")&&localStorage.setItem("darkMode","true"),initTheme()};let currentTotalMinutes=0,isEstimatedTime=!1;function calculateEpisodes(){let e=parseInt(document.getElementById("hours").value)||0,t=parseInt(document.getElementById("minutes").value)||0,n=60*e+t,o=parseInt(document.getElementById("borderMin").value)||0,i=parseInt(document.getElementById("borderMax").value)||0,l=parseEpisodeCount(document.getElementById("episodes").value);if(!e&&!t&&!o&&!i&&!l){showError("Zadaj hodnoty"),document.getElementById("result").innerHTML="";return}let[s,r]=parseRange(document.getElementById("episodeRange").value);(isEstimatedTime=0===n&&l>0)&&(n=l*(o&&i&&o!==i?(o+i)/2:Math.max(o,i))),currentTotalMinutes=n;let d=s>0?Math.round(n/s):0,a=r>0?Math.round(n/r):0,u=d>0&&a>0?Math.floor((a+d)/2):0,p="";function m(e){return 1===e?"epiz\xf3du":e>=2&&e<=4?"epiz\xf3dy":"epiz\xf3d"}isEstimatedTime&&(p+=`<strong>Odhadovan\xfd celkov\xfd čas:</strong> <span id="estimatedTime">${Math.floor(n/60)} hod ${Math.round(n%60)} min</span>`,p+=` <span class="time-adjuster">
        <select id="timeAdjustValue" class="form-select form-select-sm">
            <option value="30">30min</option>
            <option value="45">45min</option>
            <option value="60" selected>1h</option>
            <option value="120">2h</option>
            <option value="180">3h</option>
            <option value="240">4h</option>
        </select>
        <button class="btn-add" onclick="adjustTime(true)">+</button>
        <button class="btn-sub" onclick="adjustTime(false)">-</button>
        <button class="btn-reset" onclick="resetTime()">RESET</button>
        </span><br>`),p+=`<strong>Zadan\xfd celkov\xfd čas seri\xe1lu v p\xf4vodnom jazyku:</strong> ${Math.floor(n/60)} hod ${n%60} min <br>`,p+=`<strong>Celkov\xfd čas seri\xe1lu v minut\xe1ch:</strong> ${Math.round(n)} min\xfat<br><br>`,s===r?p+=`<strong>Odhadovan\xe1 dĺžka seri\xe1lu je </strong><span id="episodeCount">${u}</span> ${m(u)}.`:(p+=`<strong>Preložen\xfd seri\xe1l by mohol mať približne od</strong> <span id="minEpisodeCount">${a}</span> <strong>do</strong> <span id="maxEpisodeCount">${d}</span> ${m(d)}.<br>`,p+=`<strong>Odhadovan\xe1 dĺžka seri\xe1lu: </strong><span id="avgEpisodeCount">${u}</span> ${m(u)}.`),document.getElementById("result").innerHTML=p}function adjustTime(e){if(!isEstimatedTime)return;let t=document.getElementById("timeAdjustValue");if(t){let n=parseInt(t.value)||60;currentTotalMinutes=Math.max(0,currentTotalMinutes+(e?n:-n))}else currentTotalMinutes=Math.max(0,currentTotalMinutes+(e?60:-60));let o=Math.floor(currentTotalMinutes/60),i=Math.round(currentTotalMinutes%60);document.getElementById("estimatedTime").textContent=`${o} hod ${i} min`;let l=document.getElementById("totalMinutesDisplay");l&&(l.textContent=Math.round(currentTotalMinutes));let[s,r]=parseRange(document.getElementById("episodeRange").value),d=s>0?Math.round(currentTotalMinutes/s):0,a=r>0?Math.round(currentTotalMinutes/r):0,u=d>0&&a>0?Math.floor((a+d)/2):0;document.getElementById("episodeCount")&&(document.getElementById("episodeCount").textContent=u),document.getElementById("minEpisodeCount")&&(document.getElementById("minEpisodeCount").textContent=a),document.getElementById("maxEpisodeCount")&&(document.getElementById("maxEpisodeCount").textContent=d),document.getElementById("avgEpisodeCount")&&(document.getElementById("avgEpisodeCount").textContent=u)}function resetTime(){calculateEpisodes()}function parseRange(e){let t=e.replace(/[–—]/g,"-").replace(/^-+|-+$/g,"").trim();if(!t)return[40,50];let n=t.split("-").map(e=>e.trim());if(1===n.length){let o=parseInt(n[0])||0;return[o,o]}if(2===n.length){let i=parseInt(n[0])||0,l=parseInt(n[1])||0;return[i,l]}return showError("Neplatn\xfd rozsah! Použite napr. '43-50'."),[40,50]}function parseEpisodeCount(e){let t=e.replace(/\s+/g,"");return t?t.includes("+")?t.split("+").reduce((e,t)=>e+(parseInt(t)||0),0):parseInt(t)||0:0}function clearInputs(){["hours","minutes","episodes","episodeRange","borderMin","borderMax"].forEach(e=>{let t=document.getElementById(e);t&&(t.value="")}),document.getElementById("result").innerHTML="",toggleTimeInput(),toggleEpisodeInput()}